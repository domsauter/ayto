import{u as I,r as n,j as e,s as w}from"./auth-CiqFla1T.js";import{u as U}from"./season-B2oCyVg0.js";function V(){const{currentSeason:s,addCandidate:k,deleteCandidate:C,updateCandidate:M,loadingCurrentSeason:S,error:b}=U(),{profile:L}=I(),[u,d]=n.useState(""),[x,o]=n.useState(""),[j,c]=n.useState("Mann"),[l,m]=n.useState(null),[i,h]=n.useState(null),[p,g]=n.useState(""),f=L?.role==="admin";n.useEffect(()=>{h(null),d(""),o(""),c("Mann"),m(null),g("")},[s]);const P=t=>{h(t.id),d(t.name),o(t.age||""),c(t.gender),g(t.profile_picture_url||"")},v=()=>{h(null),d(""),o(""),c("Mann"),m(null),g("")},z=t=>{t.target.files&&t.target.files[0]?m(t.target.files[0]):m(null)},B=async t=>{if(t.preventDefault(),!u.trim()||!s||!f)return;let a=p;if(l){const A=l.name.split(".").pop(),H=`${Math.random()}.${A}`,N=`${s.id}/${H}`,{error:y,data:K}=await w.storage.from("candidate_pictures").upload(N,l,{cacheControl:"3600",upsert:!1});if(y){alert("Error uploading profile picture: "+y.message);return}const{data:{publicUrl:$}}=w.storage.from("candidate_pictures").getPublicUrl(N);a=$}const r={name:u,age:x?parseInt(x):null,gender:j,profile_picture_url:a};i?M(s.id,i,r):k(s.id,r),v()};if(!s)return e.jsxs("div",{className:"p-8",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Kandidaten"}),e.jsx("p",{children:"Bitte wähle zuerst eine Staffel aus."})]});if(S)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-pink-500"})});if(b)return e.jsxs("div",{className:"p-8 text-red-500",children:["Error: ",b]});const E=s.truthBooths.filter(t=>t.is_perfect_match).flatMap(t=>[parseInt(t.couple.man),parseInt(t.couple.woman)]),_=s.candidates.filter(t=>t.gender==="Mann"),F=s.candidates.filter(t=>t.gender==="Frau");return e.jsxs("div",{className:"p-4 md:p-8 max-w-7xl mx-auto",children:[e.jsxs("h1",{className:"text-3xl font-extrabold mb-8 bg-gradient-to-r from-pink-600 to-indigo-600 bg-clip-text text-transparent",children:["Kandidaten für ",s.name]}),f&&e.jsxs("div",{className:"mb-10 p-6 bg-white rounded-xl shadow-lg border border-gray-100",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800 border-b pb-2",children:i?"Kandidat bearbeiten":"Neuen Kandidat hinzufügen"}),e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4",children:[e.jsxs("div",{className:"md:col-span-5",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:u,onChange:t=>d(t.target.value),placeholder:"z.B. Max",className:"match-input w-full",required:!0})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Alter"}),e.jsx("input",{type:"number",value:x,onChange:t=>o(t.target.value),placeholder:"24",className:"match-input w-full"})]}),e.jsxs("div",{className:"md:col-span-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Geschlecht"}),e.jsxs("select",{value:j,onChange:t=>c(t.target.value),className:"match-input w-full",children:[e.jsx("option",{value:"Mann",children:"Mann"}),e.jsx("option",{value:"Frau",children:"Frau"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Profilbild"}),e.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md hover:border-pink-400 transition-colors",children:e.jsxs("div",{className:"space-y-1 text-center",children:[p&&!l?e.jsxs("div",{className:"mb-2",children:[e.jsx("img",{src:p,alt:"Current",className:"mx-auto h-24 w-24 rounded-full object-cover"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Aktuelles Bild"})]}):e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:e.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsxs("div",{className:"flex text-sm text-gray-600 justify-center",children:[e.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-pink-600 hover:text-pink-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-pink-500",children:[e.jsx("span",{children:"Bild hochladen"}),e.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",accept:"image/*",onChange:z})]}),e.jsx("p",{className:"pl-1",children:"oder hierhin ziehen"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG bis zu 5MB"}),l&&e.jsxs("p",{className:"text-sm text-green-600 font-semibold mt-2",children:["Ausgewählt: ",l.name]})]})})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"submit",className:"save-button flex-1 md:flex-none md:w-40 justify-center",children:i?"Speichern":"Hinzufügen"}),i&&e.jsx("button",{type:"button",onClick:v,className:"px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500",children:"Abbrechen"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[{title:"Männer",data:_,emptyMsg:"Noch keine Männer hinzugefügt."},{title:"Frauen",data:F,emptyMsg:"Noch keine Frauen hinzugefügt."}].map(t=>e.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden border border-gray-100 flex flex-col h-full",children:[e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-white px-6 py-4 border-b border-gray-100 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:t.title}),e.jsx("span",{className:"bg-gray-100 text-gray-600 py-1 px-3 rounded-full text-xs font-bold",children:t.data.length})]}),t.data.length===0?e.jsx("div",{className:"p-8 text-center text-gray-400 italic",children:t.emptyMsg}):e.jsx("ul",{className:"divide-y divide-gray-100",children:t.data.map(a=>{const r=E.includes(a.id);return e.jsxs("li",{className:`p-4 hover:bg-gray-50 transition-colors flex justify-between items-center group ${r?"opacity-60 bg-gray-50":""}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:a.profile_picture_url||`https://ui-avatars.com/api/?name=${a.name.replace(/\s/g,"+")}&background=random`,alt:a.name,className:`w-12 h-12 rounded-full object-cover border-2 shadow-sm ${r?"border-gray-300 grayscale":"border-white"}`}),r&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-gray-200 rounded-full p-1 border border-white",children:e.jsx("svg",{className:"w-3 h-3 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})})})]}),e.jsxs("div",{children:[e.jsxs("p",{className:`font-bold text-lg ${r?"text-gray-500":"text-gray-900"}`,children:[a.name," ",a.age&&e.jsxs("span",{className:"text-sm font-normal text-gray-500 ml-1",children:["(",a.age,")"]})]}),r&&e.jsx("span",{className:"text-xs text-gray-400 font-medium",children:"Perfect Match gefunden"})]})]}),f&&e.jsxs("div",{className:"flex gap-2 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>P(a),className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded-full",title:"Bearbeiten",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>C(s.id,a.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-full",title:"Löschen",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},a.id)})})]},t.title))})]})}export{V as default};
