import{r as m,j as e}from"./auth-CiqFla1T.js";import{u as P}from"./season-B2oCyVg0.js";import{s as $,a as S}from"./solver-CyFOJOAE.js";function F(){const{currentSeason:a}=P(),[h,u]=m.useState(null),[o,f]=m.useState(null),[N,j]=m.useState(null),[g,x]=m.useState(!1),{men:v,women:w}=m.useMemo(()=>a?{men:a.candidates.filter(s=>s.gender==="Mann"),women:a.candidates.filter(s=>s.gender==="Frau")}:{men:[],women:[]},[a]),y=m.useCallback(()=>{a&&(x(!0),setTimeout(()=>{try{console.log("Starting solver with season:",a);const s=$(a);console.log("Solver completed. Found",s.length,"solutions"),j(s.length);const i=S(a,s);if(f(i),console.log("Partner analysis completed:",i),s.length>0){const d={},t=s.length,n=new Set;a.matchingNights.forEach(r=>{r.couples.forEach(l=>{n.add(`${Number(l.mann)}-${Number(l.frau)}`)})}),a.truthBooths.forEach(r=>{const l=Number(r.couple.man),b=Number(r.couple.woman);n.add(`${l}-${b}`)}),n.forEach(r=>{d[r]=0}),s.forEach(r=>{n.forEach(l=>{const[b,p]=l.split("-").map(Number);r[b]===p&&d[l]++})});const c=Object.entries(d).map(([r,l])=>{const[b,p]=r.split("-").map(Number);return{manId:b,womanId:p,probability:l/t*100}});c.sort((r,l)=>l.probability-r.probability),u(c)}else u([]);x(!1)}catch(s){console.error("Error during solve:",s),alert("Fehler beim Berechnen: "+s.message),j(null),f(null),u(null),x(!1)}},0))},[a]);return e.jsxs("div",{className:"p-8",children:[e.jsxs("h1",{className:"text-2xl font-bold mb-4",children:["Predictions for ",a.name]}),e.jsx("button",{onClick:y,disabled:g,className:`px-4 py-2 rounded-md mb-8 ${g?"bg-gray-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"} text-white`,children:g?"Berechne...":"Mögliche Matches berechnen"}),N!==null&&e.jsxs("h2",{className:"text-xl font-bold mb-2",children:[N," mögliche Lösung(en) gefunden"]}),o&&o.contradictions.length>0&&e.jsxs("div",{className:"mb-6 p-4 bg-red-100 border-l-4 border-red-500 rounded",children:[e.jsx("h3",{className:"text-lg font-bold text-red-800 mb-3",children:"⚠️ Widersprüche gefunden!"}),o.contradictions.map((s,i)=>e.jsx("div",{className:"text-red-700 mb-2",children:s.message},i))]}),o&&e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-bold mb-6 text-blue-900",children:"Perfect Match Kandidaten"}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"font-bold mb-4 text-blue-800",children:"Männer"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:v.map(s=>{const i=o.men[s.id],d=h?h.filter(t=>t.manId===s.id).sort((t,n)=>n.probability-t.probability):[];return e.jsxs("div",{className:`p-4 rounded-lg ${i.possiblePartners.length===0?"bg-red-100 border-l-4 border-red-500":i.certainPartner?"bg-green-100 border-l-4 border-green-500":"bg-white border border-blue-200"}`,children:[e.jsx("p",{className:"font-bold text-lg mb-3",children:s.name}),i.possiblePartners.length===0?e.jsx("p",{className:"text-red-700",children:"❌ Kein Partner möglich"}):d.length>0?e.jsx("div",{className:"space-y-2",children:d.map(({womanId:t,probability:n},c)=>{const r=w.find(l=>l.id===t);return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm",children:[e.jsxs("span",{className:"font-semibold",children:[c+1,"."]})," ",r?.name]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${n===100?"bg-green-500":"bg-blue-500"}`,style:{width:`${n}%`}})}),e.jsxs("span",{className:"text-sm font-semibold w-10 text-right",children:[n.toFixed(1),"%"]})]})]},`${s.id}-${t}`)})}):e.jsx("p",{className:"text-sm text-gray-500",children:"Keine Daten"})]},s.id)})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold mb-4 text-pink-800",children:"Frauen"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:w.map(s=>{const i=o.women[s.id],d=h?h.filter(t=>t.womanId===s.id).sort((t,n)=>n.probability-t.probability):[];return e.jsxs("div",{className:`p-4 rounded-lg ${i.possiblePartners.length===0?"bg-red-100 border-l-4 border-red-500":i.certainPartner?"bg-green-100 border-l-4 border-green-500":"bg-white border border-pink-200"}`,children:[e.jsx("p",{className:"font-bold text-lg mb-3",children:s.name}),i.possiblePartners.length===0?e.jsx("p",{className:"text-red-700",children:"❌ Kein Partner möglich"}):d.length>0?e.jsx("div",{className:"space-y-2",children:d.map(({manId:t,probability:n},c)=>{const r=v.find(l=>l.id===t);return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm",children:[e.jsxs("span",{className:"font-semibold",children:[c+1,"."]})," ",r?.name]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${n===100?"bg-green-500":"bg-pink-500"}`,style:{width:`${n}%`}})}),e.jsxs("span",{className:"text-sm font-semibold w-10 text-right",children:[n.toFixed(1),"%"]})]})]},`${t}-${s.id}`)})}):e.jsx("p",{className:"text-sm text-gray-500",children:"Keine Daten"})]},s.id)})})]})]})]})}export{F as default};
