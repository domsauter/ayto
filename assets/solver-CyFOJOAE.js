function u(o,s){if(s===0)return[[]];if(o.length===0)return[];if(s===o.length)return[o];const c=o[0],i=o.slice(1),r=u(i,s-1).map(n=>[c,...n]),e=u(i,s);return[...r,...e]}function P(o){try{if(console.log("Solver starting..."),!o.matchingNights||!Array.isArray(o.matchingNights)||o.matchingNights.length===0)return console.log("No matching nights found"),[];const s=new Set;o.matchingNights.forEach(e=>{e.couples&&Array.isArray(e.couples)&&e.couples.forEach(n=>{const t=`${Number(n.mann)}-${Number(n.frau)}`;s.add(t)})});const c=Array.from(s).map(e=>{const[n,t]=e.split("-").map(Number);return{manId:n,womanId:t,key:e}});console.log(`Total unique couples across all nights: ${c.length}`);let i=[[]];return o.matchingNights.forEach((e,n)=>{if(!e.couples||!Array.isArray(e.couples)){console.warn(`Night ${n} has no couples`);return}console.log(`Processing night ${n}: ${e.couples.length} couples, ${e.lights} lights expected`);const t=e.couples.map(a=>`${Number(a.mann)}-${Number(a.frau)}`),l=u(t,e.lights);console.log(`Night ${n}: ${l.length} valid combinations of ${e.lights} couples`);const h=[];i.forEach(a=>{l.forEach(f=>{let b=!1;f.forEach(g=>{const p=a.find(d=>d===g)});const m=[...new Set([...a,...f])];h.push(m)})}),i=h,console.log(`After night ${n}: ${i.length} valid combinations`)}),console.log(`Solver complete: ${i.length} valid combinations`),i.map(e=>{const n={};return e.forEach(t=>{const[l,h]=t.split("-").map(Number);n[l]=h}),n})}catch(s){throw console.error("Error in solve function:",s),s}}function $(o,s){const c=o.candidates.filter(e=>e.gender==="Mann"),i=o.candidates.filter(e=>e.gender==="Frau"),r={men:{},women:{},contradictions:[]};if(c.forEach(e=>{r.men[e.id]={id:e.id,name:e.name,possiblePartners:new Set,certainPartner:null}}),i.forEach(e=>{r.women[e.id]={id:e.id,name:e.name,possiblePartners:new Set,certainPartner:null}}),s.forEach(e=>{Object.entries(e).forEach(([n,t])=>{r.men[n]&&r.men[n].possiblePartners.add(t),r.women[t]&&r.women[t].possiblePartners.add(n)})}),s.length===1){const e=s[0];Object.entries(e).forEach(([n,t])=>{r.men[n]&&(r.men[n].certainPartner=t),r.women[t]&&(r.women[t].certainPartner=n)})}return c.forEach(e=>{const n=Array.from(r.men[e.id].possiblePartners);r.men[e.id].possiblePartners=n,n.length===0&&r.contradictions.push({type:"no_partner",person:e,gender:"Mann",message:`${e.name} hat keinen möglichen Partner - es gibt einen Widerspruch in den Daten!`})}),i.forEach(e=>{const n=Array.from(r.women[e.id].possiblePartners);r.women[e.id].possiblePartners=n,n.length===0&&r.contradictions.push({type:"no_partner",person:e,gender:"Frau",message:`${e.name} hat keinen möglichen Partner - es gibt einen Widerspruch in den Daten!`})}),r}export{$ as a,P as s};
